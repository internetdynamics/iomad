{"version":3,"file":"modform.min.js","sources":["../src/modform.js"],"sourcesContent":["// This file is part of Moodle - http://moodle.org/\r\n//\r\n// Moodle is free software: you can redistribute it and/or modify\r\n// it under the terms of the GNU General Public License as published by\r\n// the Free Software Foundation, either version 3 of the License, or\r\n// (at your option) any later version.\r\n//\r\n// Moodle is distributed in the hope that it will be useful,\r\n// but WITHOUT ANY WARRANTY; without even the implied warranty of\r\n// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\r\n// GNU General Public License for more details.\r\n//\r\n// You should have received a copy of the GNU General Public License\r\n// along with Moodle.  If not, see <http://www.gnu.org/licenses/>.\r\n\r\n/**\r\n * Additional javascript for the Workshop module form.\r\n *\r\n * @module      mod_workshop/modform\r\n * @copyright   The Open University 2018\r\n * @license     http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later\r\n */\r\ndefine(['jquery'], function($) {\r\n\r\n    var submissionTypes = {\r\n        text: {\r\n            available: null,\r\n            required: null,\r\n            requiredHidden: null\r\n        },\r\n        file: {\r\n            available: null,\r\n            required: null,\r\n            requiredHidden: null\r\n        }\r\n    };\r\n\r\n    /**\r\n     * Determine whether one of the submission types has been marked as not available.\r\n     *\r\n     * If it has been marked not available, clear and disable its required checkbox.  Then determine if the other submission\r\n     * type is available, and if it is, check and disable its required checkbox.\r\n     *\r\n     * @param {Object} checkUnavailable\r\n     * @param {Object} checkAvailable\r\n     */\r\n    function checkAvailability(checkUnavailable, checkAvailable) {\r\n        if (!checkUnavailable.available.prop('checked')) {\r\n            checkUnavailable.required.prop('disabled', true);\r\n            checkUnavailable.required.prop('checked', false);\r\n            if (checkAvailable.available.prop('checked')) {\r\n                checkAvailable.required.prop('disabled', true);\r\n                checkAvailable.required.prop('checked', true);\r\n                // Also set the checkbox's hidden field to 1 so a 'required' value is submitted for the submission type.\r\n                checkAvailable.requiredHidden.val(1);\r\n            }\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Enable the submission type's required checkbox and uncheck it.\r\n     *\r\n     * @param {Object} submissionType\r\n     */\r\n    function enableRequired(submissionType) {\r\n        submissionType.required.prop('disabled', false);\r\n        submissionType.required.prop('checked', false);\r\n        submissionType.requiredHidden.val(0);\r\n    }\r\n\r\n    /**\r\n     * Check which submission types have been marked as available, and disable required checkboxes as necessary.\r\n     */\r\n    function submissionTypeChanged() {\r\n        checkAvailability(submissionTypes.file, submissionTypes.text);\r\n        checkAvailability(submissionTypes.text, submissionTypes.file);\r\n        if (submissionTypes.text.available.prop('checked') && submissionTypes.file.available.prop('checked')) {\r\n            enableRequired(submissionTypes.text);\r\n            enableRequired(submissionTypes.file);\r\n        }\r\n    }\r\n\r\n    return /** @alias module:mod_workshop/modform */ {\r\n        /**\r\n         * Find all the required fields, set up event listeners, and set the initial state of required checkboxes.\r\n         */\r\n        init: function() {\r\n            submissionTypes.text.available = $('#id_submissiontypetextavailable');\r\n            submissionTypes.text.required = $('#id_submissiontypetextrequired');\r\n            submissionTypes.text.requiredHidden = $('input[name=\"submissiontypetextrequired\"][type=\"hidden\"]');\r\n            submissionTypes.file.available = $('#id_submissiontypefileavailable');\r\n            submissionTypes.file.required = $('#id_submissiontypefilerequired');\r\n            submissionTypes.file.requiredHidden = $('input[name=\"submissiontypefilerequired\"][type=\"hidden\"]');\r\n            submissionTypes.text.available.on('change', submissionTypeChanged);\r\n            submissionTypes.file.available.on('change', submissionTypeChanged);\r\n            submissionTypeChanged();\r\n        }\r\n    };\r\n});\r\n"],"names":["define","$","submissionTypes","text","available","required","requiredHidden","file","checkAvailability","checkUnavailable","checkAvailable","prop","val","enableRequired","submissionType","submissionTypeChanged","init","on"],"mappings":";;;;;;;AAsBAA,8BAAO,CAAC,WAAW,SAASC,OAEpBC,gBAAkB,CAClBC,KAAM,CACFC,UAAW,KACXC,SAAU,KACVC,eAAgB,MAEpBC,KAAM,CACFH,UAAW,KACXC,SAAU,KACVC,eAAgB,gBAafE,kBAAkBC,iBAAkBC,gBACpCD,iBAAiBL,UAAUO,KAAK,aACjCF,iBAAiBJ,SAASM,KAAK,YAAY,GAC3CF,iBAAiBJ,SAASM,KAAK,WAAW,GACtCD,eAAeN,UAAUO,KAAK,aAC9BD,eAAeL,SAASM,KAAK,YAAY,GACzCD,eAAeL,SAASM,KAAK,WAAW,GAExCD,eAAeJ,eAAeM,IAAI,cAUrCC,eAAeC,gBACpBA,eAAeT,SAASM,KAAK,YAAY,GACzCG,eAAeT,SAASM,KAAK,WAAW,GACxCG,eAAeR,eAAeM,IAAI,YAM7BG,wBACLP,kBAAkBN,gBAAgBK,KAAML,gBAAgBC,MACxDK,kBAAkBN,gBAAgBC,KAAMD,gBAAgBK,MACpDL,gBAAgBC,KAAKC,UAAUO,KAAK,YAAcT,gBAAgBK,KAAKH,UAAUO,KAAK,aACtFE,eAAeX,gBAAgBC,MAC/BU,eAAeX,gBAAgBK,aAIU,CAI7CS,KAAM,WACFd,gBAAgBC,KAAKC,UAAYH,EAAE,mCACnCC,gBAAgBC,KAAKE,SAAWJ,EAAE,kCAClCC,gBAAgBC,KAAKG,eAAiBL,EAAE,2DACxCC,gBAAgBK,KAAKH,UAAYH,EAAE,mCACnCC,gBAAgBK,KAAKF,SAAWJ,EAAE,kCAClCC,gBAAgBK,KAAKD,eAAiBL,EAAE,2DACxCC,gBAAgBC,KAAKC,UAAUa,GAAG,SAAUF,uBAC5Cb,gBAAgBK,KAAKH,UAAUa,GAAG,SAAUF,uBAC5CA"}