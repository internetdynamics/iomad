{"version":3,"file":"notification_area_content_area.min.js","sources":["../src/notification_area_content_area.js"],"sourcesContent":["// This file is part of Moodle - http://moodle.org/\r\n//\r\n// Moodle is free software: you can redistribute it and/or modify\r\n// it under the terms of the GNU General Public License as published by\r\n// the Free Software Foundation, either version 3 of the License, or\r\n// (at your option) any later version.\r\n//\r\n// Moodle is distributed in the hope that it will be useful,\r\n// but WITHOUT ANY WARRANTY; without even the implied warranty of\r\n// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\r\n// GNU General Public License for more details.\r\n//\r\n// You should have received a copy of the GNU General Public License\r\n// along with Moodle.  If not, see <http://www.gnu.org/licenses/>.\r\n\r\n/**\r\n * Controls the content area of the notification area on the\r\n * notification page.\r\n *\r\n * @module     message_popup/notification_area_content_area\r\n * @copyright  2016 Ryan Wyllie <ryan@moodle.com>\r\n * @license    http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later\r\n */\r\ndefine(['jquery', 'core/templates', 'core/notification', 'core/custom_interaction_events',\r\n        'message_popup/notification_repository', 'message_popup/notification_area_events'],\r\n    function($, Templates, DebugNotification, CustomEvents, NotificationRepo, NotificationAreaEvents) {\r\n\r\n    var SELECTORS = {\r\n        CONTAINER: '[data-region=\"notification-area\"]',\r\n        CONTENT: '[data-region=\"content\"]',\r\n        HEADER: '[data-region=\"header\"]',\r\n        FOOTER: '[data-region=\"footer\"]',\r\n        TOGGLE_MODE: '[data-action=\"toggle-mode\"]',\r\n    };\r\n\r\n    var TEMPLATES = {\r\n        HEADER: 'message_popup/notification_area_content_area_header',\r\n        CONTENT: 'message_popup/notification_area_content_area_content',\r\n        FOOTER: 'message_popup/notification_area_content_area_footer',\r\n    };\r\n\r\n    /**\r\n     * Constructor for the ContentArea\r\n     *\r\n     * @class\r\n     * @param {object} root The root element for the content area\r\n     * @param {int} userId The user id of the current user\r\n     */\r\n    var ContentArea = function(root, userId) {\r\n        this.root = $(root);\r\n        this.container = this.root.closest(SELECTORS.CONTAINER);\r\n        this.userId = userId;\r\n        this.header = this.root.find(SELECTORS.HEADER);\r\n        this.content = this.root.find(SELECTORS.CONTENT);\r\n        this.footer = this.root.find(SELECTORS.FOOTER);\r\n\r\n        this.registerEventListeners();\r\n    };\r\n\r\n    /**\r\n     * Get the root element.\r\n     *\r\n     * @method getRoot\r\n     * @return {object} jQuery element\r\n     */\r\n    ContentArea.prototype.getRoot = function() {\r\n        return this.root;\r\n    };\r\n\r\n    /**\r\n     * Get the container element (which the content area is within).\r\n     *\r\n     * @method getContainer\r\n     * @return {object} jQuery element\r\n     */\r\n    ContentArea.prototype.getContainer = function() {\r\n        return this.container;\r\n    };\r\n\r\n    /**\r\n     * Get the user id.\r\n     *\r\n     * @method getUserId\r\n     * @return {int}\r\n     */\r\n    ContentArea.prototype.getUserId = function() {\r\n        return this.userId;\r\n    };\r\n\r\n    /**\r\n     * Get the content area header element.\r\n     *\r\n     * @method getHeader\r\n     * @return {object} jQuery element\r\n     */\r\n    ContentArea.prototype.getHeader = function() {\r\n        return this.header;\r\n    };\r\n\r\n    /**\r\n     * Get the content area content element.\r\n     *\r\n     * @method getContent\r\n     * @return {object} jQuery element\r\n     */\r\n    ContentArea.prototype.getContent = function() {\r\n        return this.content;\r\n    };\r\n\r\n    /**\r\n     * Get the content area footer element.\r\n     *\r\n     * @method getFooter\r\n     * @return {object} jQuery element\r\n     */\r\n    ContentArea.prototype.getFooter = function() {\r\n        return this.footer;\r\n    };\r\n\r\n    /**\r\n     * Display the content area. Typically used with responsive\r\n     * styling on smaller screens.\r\n     *\r\n     * @method show\r\n     */\r\n    ContentArea.prototype.show = function() {\r\n        this.getContainer().addClass('show-content-area');\r\n    };\r\n\r\n    /**\r\n     * Hide the content area. Typically used with responsive\r\n     * styling on smaller screens.\r\n     *\r\n     * @method hide\r\n     */\r\n    ContentArea.prototype.hide = function() {\r\n        this.getContainer().removeClass('show-content-area');\r\n    };\r\n\r\n    /**\r\n     * Change the HTML in the content area header element.\r\n     *\r\n     * @method setHeaderHTML\r\n     * @param {string} html The HTML to be set\r\n     */\r\n    ContentArea.prototype.setHeaderHTML = function(html) {\r\n        this.getHeader().empty().html(html);\r\n    };\r\n\r\n    /**\r\n     * Change the HTML in the content area content element.\r\n     *\r\n     * @method setContentHMTL\r\n     * @param {string} html The HTML to be set.\r\n     */\r\n    ContentArea.prototype.setContentHTML = function(html) {\r\n        this.getContent().empty().html(html);\r\n    };\r\n\r\n    /**\r\n     * Change the HTML in the content area footer element.\r\n     *\r\n     * @method setFooterHTML\r\n     * @param {string} html The HTML to be set.\r\n     */\r\n    ContentArea.prototype.setFooterHTML = function(html) {\r\n        this.getFooter().empty().html(html);\r\n    };\r\n\r\n    /**\r\n     * Render the given notification context in the content area.\r\n     *\r\n     * @method showNotification\r\n     * @param {object} notification The notification context (from a webservice)\r\n     * @return {object} jQuery promise\r\n     */\r\n    ContentArea.prototype.showNotification = function(notification) {\r\n        var headerPromise = Templates.render(TEMPLATES.HEADER, notification).done(function(html) {\r\n            this.setHeaderHTML(html);\r\n        }.bind(this));\r\n\r\n        var contentPromise = Templates.render(TEMPLATES.CONTENT, notification).done(function(html) {\r\n            this.setContentHTML(html);\r\n        }.bind(this));\r\n\r\n        var footerPromise = Templates.render(TEMPLATES.FOOTER, notification).done(function(html) {\r\n            this.setFooterHTML(html);\r\n        }.bind(this));\r\n\r\n        return $.when(headerPromise, contentPromise, footerPromise).done(function() {\r\n            this.show();\r\n            this.getContainer().trigger(NotificationAreaEvents.notificationShown, [notification]);\r\n        }.bind(this));\r\n    };\r\n\r\n    /**\r\n     * Create the event listeners for the content area.\r\n     *\r\n     * @method registerEventListeners\r\n     */\r\n    ContentArea.prototype.registerEventListeners = function() {\r\n        CustomEvents.define(this.getRoot(), [\r\n            CustomEvents.events.activate\r\n        ]);\r\n\r\n        this.getRoot().on(CustomEvents.events.activate, SELECTORS.VIEW_TOGGLE, function() {\r\n            this.hide();\r\n        }.bind(this));\r\n\r\n        this.getContainer().on(NotificationAreaEvents.showNotification, function(e, notification) {\r\n            this.showNotification(notification);\r\n        }.bind(this));\r\n    };\r\n\r\n    return ContentArea;\r\n});\r\n"],"names":["define","$","Templates","DebugNotification","CustomEvents","NotificationRepo","NotificationAreaEvents","SELECTORS","CONTAINER","CONTENT","HEADER","FOOTER","TOGGLE_MODE","TEMPLATES","ContentArea","root","userId","container","this","closest","header","find","content","footer","registerEventListeners","prototype","getRoot","getContainer","getUserId","getHeader","getContent","getFooter","show","addClass","hide","removeClass","setHeaderHTML","html","empty","setContentHTML","setFooterHTML","showNotification","notification","headerPromise","render","done","bind","contentPromise","footerPromise","when","trigger","notificationShown","events","activate","on","VIEW_TOGGLE","e"],"mappings":";;;;;;;;AAuBAA,sDAAO,CAAC,SAAU,iBAAkB,oBAAqB,iCACjD,wCAAyC,2CAC7C,SAASC,EAAGC,UAAWC,kBAAmBC,aAAcC,iBAAkBC,4BAEtEC,UAAY,CACZC,UAAW,oCACXC,QAAS,0BACTC,OAAQ,yBACRC,OAAQ,yBACRC,YAAa,+BAGbC,iBACQ,sDADRA,kBAES,uDAFTA,iBAGQ,sDAURC,YAAc,SAASC,KAAMC,aACxBD,KAAOd,EAAEc,WACTE,UAAYC,KAAKH,KAAKI,QAAQZ,UAAUC,gBACxCQ,OAASA,YACTI,OAASF,KAAKH,KAAKM,KAAKd,UAAUG,aAClCY,QAAUJ,KAAKH,KAAKM,KAAKd,UAAUE,cACnCc,OAASL,KAAKH,KAAKM,KAAKd,UAAUI,aAElCa,iCASTV,YAAYW,UAAUC,QAAU,kBACrBR,KAAKH,MAShBD,YAAYW,UAAUE,aAAe,kBAC1BT,KAAKD,WAShBH,YAAYW,UAAUG,UAAY,kBACvBV,KAAKF,QAShBF,YAAYW,UAAUI,UAAY,kBACvBX,KAAKE,QAShBN,YAAYW,UAAUK,WAAa,kBACxBZ,KAAKI,SAShBR,YAAYW,UAAUM,UAAY,kBACvBb,KAAKK,QAShBT,YAAYW,UAAUO,KAAO,gBACpBL,eAAeM,SAAS,sBASjCnB,YAAYW,UAAUS,KAAO,gBACpBP,eAAeQ,YAAY,sBASpCrB,YAAYW,UAAUW,cAAgB,SAASC,WACtCR,YAAYS,QAAQD,KAAKA,OASlCvB,YAAYW,UAAUc,eAAiB,SAASF,WACvCP,aAAaQ,QAAQD,KAAKA,OASnCvB,YAAYW,UAAUe,cAAgB,SAASH,WACtCN,YAAYO,QAAQD,KAAKA,OAUlCvB,YAAYW,UAAUgB,iBAAmB,SAASC,kBAC1CC,cAAgBzC,UAAU0C,OAAO/B,iBAAkB6B,cAAcG,KAAK,SAASR,WAC1ED,cAAcC,OACrBS,KAAK5B,OAEH6B,eAAiB7C,UAAU0C,OAAO/B,kBAAmB6B,cAAcG,KAAK,SAASR,WAC5EE,eAAeF,OACtBS,KAAK5B,OAEH8B,cAAgB9C,UAAU0C,OAAO/B,iBAAkB6B,cAAcG,KAAK,SAASR,WAC1EG,cAAcH,OACrBS,KAAK5B,cAEAjB,EAAEgD,KAAKN,cAAeI,eAAgBC,eAAeH,KAAK,gBACxDb,YACAL,eAAeuB,QAAQ5C,uBAAuB6C,kBAAmB,CAACT,gBACzEI,KAAK5B,QAQXJ,YAAYW,UAAUD,uBAAyB,WAC3CpB,aAAaJ,OAAOkB,KAAKQ,UAAW,CAChCtB,aAAagD,OAAOC,gBAGnB3B,UAAU4B,GAAGlD,aAAagD,OAAOC,SAAU9C,UAAUgD,YAAa,gBAC9DrB,QACPY,KAAK5B,YAEFS,eAAe2B,GAAGhD,uBAAuBmC,iBAAkB,SAASe,EAAGd,mBACnED,iBAAiBC,eACxBI,KAAK5B,QAGJJ"}