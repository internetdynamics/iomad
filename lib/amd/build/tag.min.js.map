{"version":3,"file":"tag.min.js","sources":["../src/tag.js"],"sourcesContent":["// This file is part of Moodle - http://moodle.org/\r\n//\r\n// Moodle is free software: you can redistribute it and/or modify\r\n// it under the terms of the GNU General Public License as published by\r\n// the Free Software Foundation, either version 3 of the License, or\r\n// (at your option) any later version.\r\n//\r\n// Moodle is distributed in the hope that it will be useful,\r\n// but WITHOUT ANY WARRANTY; without even the implied warranty of\r\n// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\r\n// GNU General Public License for more details.\r\n//\r\n// You should have received a copy of the GNU General Public License\r\n// along with Moodle.  If not, see <http://www.gnu.org/licenses/>.\r\n\r\n/**\r\n * AJAX helper for the tag management page.\r\n *\r\n * @module     core/tag\r\n * @copyright  2015 Marina Glancy\r\n * @license    http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later\r\n * @since      3.0\r\n */\r\ndefine([\r\n    'jquery',\r\n    'core/ajax',\r\n    'core/templates',\r\n    'core/notification',\r\n    'core/str',\r\n    'core/modal_factory',\r\n    'core/modal_events',\r\n    'core/pending',\r\n], function(\r\n    $,\r\n    ajax,\r\n    templates,\r\n    notification,\r\n    str,\r\n    ModalFactory,\r\n    ModalEvents,\r\n    Pending\r\n) {\r\n    return /** @alias module:core/tag */ {\r\n\r\n        /**\r\n         * Initialises tag index page.\r\n         *\r\n         * @method initTagindexPage\r\n         */\r\n        initTagindexPage: function() {\r\n            // Click handler for changing tag type.\r\n            $('body').delegate('.tagarea[data-ta] a[data-quickload=1]', 'click', function(e) {\r\n                var pendingPromise = new Pending('core/tag:initTagindexPage');\r\n\r\n                e.preventDefault();\r\n                var target = $(this);\r\n                var query = target[0].search.replace(/^\\?/, '');\r\n                var tagarea = target.closest('.tagarea[data-ta]');\r\n                var args = query.split('&').reduce(function(s, c) {\r\n                      var t = c.split('=');\r\n                      s[t[0]] = decodeURIComponent(t[1]);\r\n                      return s;\r\n                    }, {});\r\n\r\n                ajax.call([{\r\n                    methodname: 'core_tag_get_tagindex',\r\n                    args: {tagindex: args}\r\n                }])[0]\r\n                .then(function(data) {\r\n                    return templates.render('core_tag/index', data);\r\n                })\r\n                .then(function(html, js) {\r\n                    templates.replaceNode(tagarea, html, js);\r\n                    return;\r\n                })\r\n                .always(pendingPromise.resolve)\r\n                .catch(notification.exception);\r\n            });\r\n        },\r\n\r\n        /**\r\n         * Initialises tag management page.\r\n         *\r\n         * @method initManagePage\r\n         */\r\n        initManagePage: function() {\r\n            // Set cell 'time modified' to 'now' when any of the element is updated in this row.\r\n            $('body').on('updated', '[data-inplaceeditable]', function(e) {\r\n                var pendingPromise = new Pending('core/tag:initManagePage');\r\n\r\n                str.get_strings([\r\n                    {\r\n                        key: 'selecttag',\r\n                        component: 'core_tag',\r\n                    },\r\n                    {\r\n                        key: 'now',\r\n                        component: 'core',\r\n                    },\r\n                ])\r\n                .then(function(result) {\r\n                    $('label[for=\"tagselect' + e.ajaxreturn.itemid + '\"]').html(result[0]);\r\n                    $(e.target).closest('tr').find('td.col-timemodified').html(result[1]);\r\n\r\n                    return;\r\n                })\r\n                .always(pendingPromise.resolve)\r\n                .catch(notification.exception);\r\n\r\n                if (e.ajaxreturn.itemtype === 'tagflag') {\r\n                    var row = $(e.target).closest('tr');\r\n                    if (e.ajaxreturn.value === '0') {\r\n                        row.removeClass('table-warning');\r\n                    } else {\r\n                        row.addClass('table-warning');\r\n                    }\r\n                }\r\n            });\r\n\r\n            // Confirmation for single tag delete link.\r\n            $('.tag-management-table').delegate('a.tagdelete', 'click', function(e) {\r\n                var pendingPromise = new Pending('core/tag:tagdelete');\r\n\r\n                e.preventDefault();\r\n                var href = $(this).attr('href');\r\n                str.get_strings([\r\n                    {key: 'delete', component: 'core'},\r\n                    {key: 'confirmdeletetag', component: 'tag'},\r\n                    {key: 'yes', component: 'core'},\r\n                    {key: 'no', component: 'core'},\r\n                ])\r\n                .then(function(s) {\r\n                    return notification.confirm(s[0], s[1], s[2], s[3], function() {\r\n                        window.location.href = href;\r\n                    });\r\n                })\r\n                .always(pendingPromise.resolve)\r\n                .catch(notification.exception);\r\n            });\r\n\r\n            // Confirmation for bulk tag delete button.\r\n            $(\"#tag-management-delete\").click(function(e) {\r\n                var form = $(this).closest('form').get(0);\r\n\r\n                var cnt = $(form).find(\"input[data-togglegroup='tags-manage'][data-toggle='slave']:checked\").length;\r\n                if (!cnt) {\r\n                    return;\r\n                }\r\n\r\n                var pendingPromise = new Pending('core/tag:tag-management-delete');\r\n                var tempElement = $(\"<input type='hidden'/>\").attr('name', this.name);\r\n                e.preventDefault();\r\n                str.get_strings([\r\n                    {key: 'delete', component: 'core'},\r\n                    {key: 'confirmdeletetags', component: 'tag'},\r\n                    {key: 'yes', component: 'core'},\r\n                    {key: 'no', component: 'core'},\r\n                ])\r\n                .then(function(s) {\r\n                    return notification.confirm(s[0], s[1], s[2], s[3], function() {\r\n                        tempElement.appendTo(form);\r\n                        form.submit();\r\n                    });\r\n                })\r\n                .always(pendingPromise.resolve)\r\n                .catch(notification.exception);\r\n            });\r\n\r\n            // Confirmation for bulk tag combine button.\r\n            $(\"#tag-management-combine\").click(function(e) {\r\n                var pendingPromise = new Pending('core/tag:tag-management-combine');\r\n\r\n                e.preventDefault();\r\n                var form = $(this).closest('form').get(0);\r\n                var tags = $(form).find(\"input[data-togglegroup='tags-manage'][data-toggle='slave']:checked\");\r\n\r\n                if (tags.length <= 1) {\r\n                    str.get_strings([\r\n                        {key: 'combineselected', component: 'tag'},\r\n                        {key: 'selectmultipletags', component: 'tag'},\r\n                        {key: 'ok'},\r\n                    ])\r\n                    .then(function(s) {\r\n                        return notification.alert(s[0], s[1], s[2]);\r\n                    })\r\n                    .always(pendingPromise.resolve)\r\n                    .catch(notification.exception);\r\n\r\n                    return;\r\n                }\r\n\r\n                var tempElement = $(\"<input type='hidden'/>\").attr('name', this.name);\r\n                var saveButtonText = '';\r\n                var tagOptions = [];\r\n                tags.each(function() {\r\n                    var tagid = $(this).val(),\r\n                        tagname = $('.inplaceeditable[data-itemtype=tagname][data-itemid=' + tagid + ']').attr('data-value');\r\n                    tagOptions.push({\r\n                        id: tagid,\r\n                        name: tagname\r\n                    });\r\n                });\r\n\r\n                str.get_strings([\r\n                    {key: 'combineselected', component: 'tag'},\r\n                    {key: 'continue', component: 'core'}\r\n                ])\r\n                .then(function(langStrings) {\r\n                    var modalTitle = langStrings[0];\r\n                    saveButtonText = langStrings[1];\r\n                    var templateContext = {\r\n                        tags: tagOptions\r\n                    };\r\n                    return ModalFactory.create({\r\n                        title: modalTitle,\r\n                        body: templates.render('core_tag/combine_tags', templateContext),\r\n                        type: ModalFactory.types.SAVE_CANCEL\r\n                    });\r\n                })\r\n                .then(function(modal) {\r\n                    modal.setSaveButtonText(saveButtonText);\r\n\r\n                    return modal;\r\n                })\r\n                .then(function(modal) {\r\n\r\n                    // Handle save event.\r\n                    modal.getRoot().on(ModalEvents.save, function(e) {\r\n                        e.preventDefault();\r\n\r\n                        // Append this temp element in the form in the tags list, not the form in the modal. Confusing, right?!?\r\n                        tempElement.appendTo(form);\r\n                        // Get the selected tag from the modal.\r\n                        var maintag = $('input[name=maintag]:checked', '#combinetags_form').val();\r\n                        // Append this in the tags list form.\r\n                        $(\"<input type='hidden'/>\").attr('name', 'maintag').attr('value', maintag).appendTo(form);\r\n                        // Submit the tags list form.\r\n                        form.submit();\r\n                    });\r\n\r\n                    // Handle hidden event.\r\n                    modal.getRoot().on(ModalEvents.hidden, function() {\r\n                        // Destroy when hidden.\r\n                        modal.destroy();\r\n                    });\r\n\r\n                    modal.show();\r\n                    // Tick the first option.\r\n                    $('#combinetags_form input[type=radio]').first().focus().prop('checked', true);\r\n\r\n                    return;\r\n\r\n                })\r\n                .always(pendingPromise.resolve)\r\n                .catch(notification.exception);\r\n            });\r\n\r\n            // When user changes tag name to some name that already exists suggest to combine the tags.\r\n            $('body').on('updatefailed', '[data-inplaceeditable][data-itemtype=tagname]', function(e) {\r\n                var exception = e.exception; // The exception object returned by the callback.\r\n                var newvalue = e.newvalue; // The value that user tried to udpated the element to.\r\n                var tagid = $(e.target).attr('data-itemid');\r\n                if (exception.errorcode === 'namesalreadybeeingused') {\r\n                    var pendingPromise = new Pending('core/tag:updatefailed');\r\n\r\n                    e.preventDefault(); // This will prevent default error dialogue.\r\n                    str.get_strings([\r\n                        {key: 'confirm', component: 'core'},\r\n                        {key: 'nameuseddocombine', component: 'tag'},\r\n                        {key: 'yes', component: 'core'},\r\n                        {key: 'cancel', component: 'core'},\r\n                    ])\r\n                    .then(function(s) {\r\n                        return notification.confirm(s[0], s[1], s[2], s[3], function() {\r\n                            window.location.href = window.location.href + \"&newname=\" + encodeURIComponent(newvalue) +\r\n                                \"&tagid=\" + encodeURIComponent(tagid) +\r\n                                '&action=renamecombine&sesskey=' + M.cfg.sesskey;\r\n                        });\r\n                    })\r\n                    .always(pendingPromise.resolve)\r\n                    .catch(notification.exception);\r\n                }\r\n            });\r\n\r\n            // Form for adding standard tags.\r\n            $('body').on('click', 'a[data-action=addstandardtag]', function(e) {\r\n                var pendingPromise = new Pending('core/tag:addstandardtag');\r\n                e.preventDefault();\r\n\r\n                return ModalFactory.create({\r\n                    title: str.get_string('addotags', 'tag'),\r\n                    body: templates.render('core_tag/add_tags', {\r\n                        actionurl: window.location.href,\r\n                        sesskey: M.cfg.sesskey\r\n                    }),\r\n                    type: ModalFactory.types.SAVE_CANCEL\r\n                })\r\n                .then(function(modal) {\r\n                    modal.setSaveButtonText(str.get_string('continue', 'core'));\r\n\r\n                    // Handle save event.\r\n                    modal.getRoot().on(ModalEvents.save, function(e) {\r\n                        var tagsInput = $(e.currentTarget).find('#id_tagslist');\r\n                        var name = tagsInput.val().trim();\r\n\r\n                        // Set the text field's value to the trimmed value.\r\n                        tagsInput.val(name);\r\n\r\n                        // Add submit event listener to the form.\r\n                        var tagsForm = $('#addtags_form');\r\n                        tagsForm.on('submit', function(e) {\r\n                            // Validate the form.\r\n                            var form = $('#addtags_form');\r\n                            if (form[0].checkValidity() === false) {\r\n                                e.preventDefault();\r\n                                e.stopPropagation();\r\n                            }\r\n                            form.addClass('was-validated');\r\n\r\n                            // BS2 compatibility.\r\n                            $('[data-region=\"tagslistinput\"]').addClass('error');\r\n                            var errorMessage = $('#id_tagslist_error_message');\r\n                            errorMessage.removeAttr('hidden');\r\n                            errorMessage.addClass('help-block');\r\n                        });\r\n\r\n                        // Try to submit the form.\r\n                        tagsForm.submit();\r\n\r\n                        return false;\r\n                    });\r\n\r\n                    // Handle hidden event.\r\n                    modal.getRoot().on(ModalEvents.hidden, function() {\r\n                        // Destroy when hidden.\r\n                        modal.destroy();\r\n                    });\r\n\r\n                    modal.show();\r\n\r\n                    return;\r\n\r\n                })\r\n                .always(pendingPromise.resolve)\r\n                .catch(notification.exception);\r\n            });\r\n        },\r\n\r\n        /**\r\n         * Initialises tag collection management page.\r\n         *\r\n         * @method initManageCollectionsPage\r\n         */\r\n        initManageCollectionsPage: function() {\r\n            $('body').on('updated', '[data-inplaceeditable]', function(e) {\r\n                var pendingPromise = new Pending('core/tag:initManageCollectionsPage-updated');\r\n\r\n                var ajaxreturn = e.ajaxreturn,\r\n                    areaid, collid, isenabled;\r\n                if (ajaxreturn.component === 'core_tag' && ajaxreturn.itemtype === 'tagareaenable') {\r\n                    areaid = $(this).attr('data-itemid');\r\n                    $(\".tag-collections-table ul[data-collectionid] li[data-areaid=\" + areaid + \"]\").hide();\r\n                    isenabled = ajaxreturn.value;\r\n                    if (isenabled === '1') {\r\n                        $(this).closest('tr').removeClass('dimmed_text');\r\n                        collid = $(this).closest('tr').find('[data-itemtype=\"tagareacollection\"]').attr(\"data-value\");\r\n                        $(\".tag-collections-table ul[data-collectionid=\" + collid + \"] li[data-areaid=\" + areaid + \"]\").show();\r\n                    } else {\r\n                        $(this).closest('tr').addClass('dimmed_text');\r\n                    }\r\n                }\r\n                if (ajaxreturn.component === 'core_tag' && ajaxreturn.itemtype === 'tagareacollection') {\r\n                    areaid = $(this).attr('data-itemid');\r\n                    $(\".tag-collections-table ul[data-collectionid] li[data-areaid=\" + areaid + \"]\").hide();\r\n                    collid = $(this).attr('data-value');\r\n                    isenabled = $(this).closest('tr').find('[data-itemtype=\"tagareaenable\"]').attr(\"data-value\");\r\n                    if (isenabled === \"1\") {\r\n                        $(\".tag-collections-table ul[data-collectionid=\" + collid + \"] li[data-areaid=\" + areaid + \"]\").show();\r\n                    }\r\n                }\r\n\r\n                pendingPromise.resolve();\r\n            });\r\n\r\n            $('body').on('click', '.addtagcoll > a', function(e) {\r\n                var pendingPromise = new Pending('core/tag:initManageCollectionsPage-addtagcoll');\r\n\r\n                e.preventDefault();\r\n                var keys = [\r\n                    {\r\n                        key: 'addtagcoll',\r\n                        component: 'tag'\r\n                    },\r\n                    {\r\n                        key: 'create',\r\n                        component: 'core'\r\n                    }\r\n                ];\r\n\r\n                var href = $(this).attr('data-url');\r\n                var saveButtonText = '';\r\n                str.get_strings(keys)\r\n                .then(function(langStrings) {\r\n                    var modalTitle = langStrings[0];\r\n                    saveButtonText = langStrings[1];\r\n                    var templateContext = {\r\n                        actionurl: href,\r\n                        sesskey: M.cfg.sesskey\r\n                    };\r\n                    return ModalFactory.create({\r\n                        title: modalTitle,\r\n                        body: templates.render('core_tag/add_tag_collection', templateContext),\r\n                        type: ModalFactory.types.SAVE_CANCEL\r\n                    });\r\n                })\r\n                .then(function(modal) {\r\n                    modal.setSaveButtonText(saveButtonText);\r\n\r\n                    // Handle save event.\r\n                    modal.getRoot().on(ModalEvents.save, function(e) {\r\n                        var collectionInput = $(e.currentTarget).find('#addtagcoll_name');\r\n                        var name = collectionInput.val().trim();\r\n                        // Set the text field's value to the trimmed value.\r\n                        collectionInput.val(name);\r\n\r\n                        // Add submit event listener to the form.\r\n                        var form = $('#addtagcoll_form');\r\n                        form.on('submit', function(e) {\r\n                            // Validate the form.\r\n                            if (form[0].checkValidity() === false) {\r\n                                e.preventDefault();\r\n                                e.stopPropagation();\r\n                            }\r\n                            form.addClass('was-validated');\r\n\r\n                            // BS2 compatibility.\r\n                            $('[data-region=\"addtagcoll_nameinput\"]').addClass('error');\r\n                            var errorMessage = $('#id_addtagcoll_name_error_message');\r\n                            errorMessage.removeAttr('hidden');\r\n                            errorMessage.addClass('help-block');\r\n                        });\r\n\r\n                        // Try to submit the form.\r\n                        form.submit();\r\n\r\n                        return false;\r\n                    });\r\n\r\n                    // Handle hidden event.\r\n                    modal.getRoot().on(ModalEvents.hidden, function() {\r\n                        // Destroy when hidden.\r\n                        modal.destroy();\r\n                    });\r\n\r\n                    modal.show();\r\n\r\n                    return modal;\r\n\r\n                })\r\n                .always(pendingPromise.resolve)\r\n                .catch(notification.exception);\r\n            });\r\n\r\n            $('body').on('click', '.tag-collections-table .action_delete', function(e) {\r\n                var pendingPromise = new Pending('core/tag:initManageCollectionsPage-action_delete');\r\n\r\n                e.preventDefault();\r\n                var href = $(this).attr('data-url') + '&sesskey=' + M.cfg.sesskey;\r\n                str.get_strings([\r\n                    {key: 'delete'},\r\n                    {key: 'suredeletecoll', component: 'tag', param: $(this).attr('data-collname')},\r\n                    {key: 'yes'},\r\n                    {key: 'no'},\r\n                ])\r\n                .then(function(s) {\r\n                    return notification.confirm(s[0], s[1], s[2], s[3], function() {\r\n                        window.location.href = href;\r\n                    });\r\n                })\r\n                .always(pendingPromise.resolve)\r\n                .catch(notification.exception);\r\n            });\r\n        }\r\n    };\r\n});\r\n"],"names":["define","$","ajax","templates","notification","str","ModalFactory","ModalEvents","Pending","initTagindexPage","delegate","e","pendingPromise","preventDefault","target","this","query","search","replace","tagarea","closest","args","split","reduce","s","c","t","decodeURIComponent","call","methodname","tagindex","then","data","render","html","js","replaceNode","always","resolve","catch","exception","initManagePage","on","get_strings","key","component","result","ajaxreturn","itemid","find","itemtype","row","value","removeClass","addClass","href","attr","confirm","window","location","click","form","get","length","tempElement","name","appendTo","submit","tags","alert","saveButtonText","tagOptions","each","tagid","val","tagname","push","id","langStrings","modalTitle","templateContext","create","title","body","type","types","SAVE_CANCEL","modal","setSaveButtonText","getRoot","save","maintag","hidden","destroy","show","first","focus","prop","newvalue","errorcode","encodeURIComponent","M","cfg","sesskey","get_string","actionurl","tagsInput","currentTarget","trim","tagsForm","checkValidity","stopPropagation","errorMessage","removeAttr","initManageCollectionsPage","areaid","collid","hide","collectionInput","param"],"mappings":"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"}